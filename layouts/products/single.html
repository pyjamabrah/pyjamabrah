{{ define "main" }}
  <main>
    <article>
      <!-- <h1 class="title">{{ .Title }}</h1> -->
      <div class="content post-container">
        <div class="post-content">
          {{ if .Params.param.bundle }}
            {{ range .Params.param.bundle }}
                {{/*  <hr/>  */}}
                <div class="course-name">
                  <h2 class="course-title">{{ .course }}</h2>
                  <div class="course-subtitle">{{ .subtitle | markdownify }}</div>
                </div>
                <div class="details-body">
                  {{ partial "products/description.html" . }}
                  {{ partial "products/content-summary.html" . }}
                  {{ partial "products/message.html" . }}
                  {{ partial "products/learning.html" . }}
                  {{/*  {{ partial "products/preview.html" . }}  */}}
                  {{ partial "products/sections-list.html" . }}
                </div>
            {{ end }}
          {{ end }}
          {{ if .Content}}
            {{ .Content }}
          {{ end }}
          {{ if .Params.param.bundle }}
          {{ range .Params.param.bundle }}
              <div class="details-body">
                {{ partial "products/certificate.html" . }}
                {{ partial "products/compare.html" . }}
                {{ partial "products/instructors.html" . }}
                {{ partial "products/reviews.html" . }}
                {{ partial "products/requirements.html" . }}
                {{ partial "products/audience.html" . }}
                {{ partial "products/faqs.html" . }}
              </div>
          {{ end }}
        {{ end }}
        </div>
        {{ partial "sidebar.html" (index .Site.Data.courses .Params.product) }}
        {{if  (index .Site.Data.courses .Params.product).paybuttonID }}
        {{ partial "products/paybutton.html" (index .Site.Data.courses .Params.product).paybuttonID }}
        {{ else }}
        {{ partial "products/enroll.html" (index .Site.Data.courses .Params.product).enroll }}
        {{ end }}
      </div>
    </article>
  </main>
  <script>
    const countryPrices = {
      'US': { quarterly: 35.99, yearly: 119.9, quarterlyOriginal: 174.9, yearlyOriginal: 699, currency: 'USD', symbol: '$' },
      'GB': { quarterly: 29.99, yearly: 102.9, quarterlyOriginal: 149, yearlyOriginal: 599, currency: 'GBP', symbol: '£' },
      'IN': { quarterly: 2999, yearly: 9999, quarterlyOriginal: 8999, yearlyOriginal: 35999, currency: 'INR', symbol: '₹' },
      'default': { quarterly: 35.99, yearly: 119.9, quarterlyOriginal: 174.9, yearlyOriginal: 699, currency: 'USD', symbol: '$' }
    };

    async function getCountryCode() {
      try {
        // Fetch country code from ipapi.co
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();
        return data.country_code || 'default'; // Returns ISO 3166-1 alpha-2 code (e.g., 'US')
      } catch (error) {
        console.error('Error fetching country code:', error);
        return 'default'; // Fallback to default if API fails
      }
    }

    async function updateButtonPrices() {
      const country = await getCountryCode();
      console.log(country)
      const prices = countryPrices[country] || countryPrices['default'];

      const quarterlyBtn = document.querySelector('.btn-quarterly');
      const yearlyBtn = document.querySelector('.btn-yearly');

      if (quarterlyBtn) {
        quarterlyBtn.innerHTML = `<s>${prices.symbol}${prices.quarterlyOriginal}</s> ${prices.symbol}${prices.quarterly}/Quarter`;
      }

      if (yearlyBtn) {
        yearlyBtn.innerHTML = `<s>${prices.symbol}${prices.yearlyOriginal}</s> ${prices.symbol}${prices.yearly}/Year`;
      }
    }

    // Run when DOM is loaded
    document.addEventListener('DOMContentLoaded', updateButtonPrices);
  </script>
{{ end }}

